{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nimport Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nVue.use(VueRouter); //解决重复提交相同链接报错\n\nVueRouter.prototype.push = function push(location, onResolve, onReject) {\n  if (onResolve || onReject) return originalPush.call(this, location, onResolve, onReject);\n  return originalPush.call(this, location).catch(function (err) {\n    if (VueRouter.isNavigationFailure(err)) {\n      // resolve err\n      return err;\n    } // rethrow error\n\n\n    return Promise.reject(err);\n  });\n};\n\nvar originalReplace = VueRouter.prototype.replace;\n\nVueRouter.prototype.replace = function replace(location, onResolve, onReject) {\n  if (onResolve || onReject) {\n    //回调函数里面会用到this的指向,所以就要使用call\n    return originalReplace.call(this, location, onResolve, onReject);\n  }\n\n  return originalReplace.call(this, location).catch(function (err) {\n    if (VueRouter.isNavigationFailure(err)) {\n      //如果为相同链接引发的错误,返回错误原因,promise状态为resolve\n      // resolve err\n      return err;\n    } // rethrow error\n\n\n    return Promise.reject(err);\n  });\n};\n\nvar routes = [{\n  path: \"/login\",\n  component: function component() {\n    return import(\"@/view/Login.vue\");\n  }\n}, {\n  path: \"/\",\n  redirect: \"/login\"\n}, {\n  path: \"/center\",\n  name: \"center\",\n  component: function component() {\n    return import(\"@/view/Center.vue\");\n  },\n  beforeEach: function beforeEach(to, from, next) {\n    //token存在并且路径也正确\n    if (from.path === \"/login\" && hasCookie) {\n      next();\n    } else {\n      next(\"/login\");\n    }\n  }\n}];\nvar router = new VueRouter({\n  routes: routes\n}); //判断是否有我们存储的token数据\n\nfunction hasCookie() {\n  var isHas = false;\n  cookie.split(\";\").forEach(function (item) {\n    if (item.startsWith(\"user_token=\")) {\n      console.log(\"存在token\");\n      isHas = true;\n    }\n  });\n  return isHas;\n}\n\nrouter.beforeEach(function (to, from, next) {\n  if (to.path == \"/login\") {\n    if (hasCookie) {\n      next(\"/center\");\n    } else {\n      next(\"/\");\n    }\n  } else {\n    next();\n  }\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","use","prototype","push","location","onResolve","onReject","originalPush","call","catch","err","isNavigationFailure","Promise","reject","originalReplace","replace","routes","path","component","redirect","name","beforeEach","to","from","next","hasCookie","router","isHas","cookie","split","forEach","item","startsWith","console","log"],"sources":["D:/develop/phpstudy_pro/WWW/vue_mobile_littel_demo/src/router/index.js"],"sourcesContent":["import Vue from \"vue\"\r\nimport VueRouter from \"vue-router\"\r\nVue.use(VueRouter);\r\n//解决重复提交相同链接报错\r\nVueRouter.prototype.push = function push(location, onResolve, onReject) {\r\n    if (onResolve || onReject)\r\n        return originalPush.call(this, location, onResolve, onReject)\r\n    return originalPush.call(this, location).catch((err) => {\r\n        if (VueRouter.isNavigationFailure(err)) {\r\n            // resolve err\r\n            return err\r\n        }\r\n        // rethrow error\r\n        return Promise.reject(err)\r\n    })\r\n}\r\nconst originalReplace = VueRouter.prototype.replace\r\nVueRouter.prototype.replace = function replace(location, onResolve, onReject) {\r\n    if (onResolve || onReject){\r\n        //回调函数里面会用到this的指向,所以就要使用call\r\n        return originalReplace.call(this, location, onResolve, onReject)\r\n    }\r\n    return originalReplace.call(this, location).catch((err) => {\r\n        if (VueRouter.isNavigationFailure(err)) {\r\n            //如果为相同链接引发的错误,返回错误原因,promise状态为resolve\r\n            // resolve err\r\n            return err\r\n        }\r\n        // rethrow error\r\n        return Promise.reject(err)\r\n    })\r\n}\r\n\r\nconst routes = [\r\n    {\r\n\r\n        path: \"/login\",\r\n        component: () => import(\"@/view/Login.vue\")\r\n    },\r\n  \r\n    {\r\n        path:\"/\",\r\n        redirect:\"/login\"\r\n    },\r\n    {\r\n        path:\"/center\",\r\n        name:\"center\",\r\n        component:() => import(\"@/view/Center.vue\"),\r\n        beforeEach:(to,from,next)=>{\r\n            //token存在并且路径也正确\r\n            if(from.path === \"/login\" && hasCookie){\r\n                next();\r\n            }else{\r\n                next(\"/login\");\r\n            }\r\n        }\r\n    },\r\n    \r\n]\r\n\r\nconst router = new VueRouter({\r\n    routes,\r\n})\r\n\r\n//判断是否有我们存储的token数据\r\nfunction hasCookie(){\r\n    let isHas = false;\r\n    cookie.split(\";\").forEach(item=>{\r\n        if(item.startsWith(\"user_token=\")){\r\n            console.log(\"存在token\");\r\n            isHas = true;\r\n        }\r\n    });\r\n    return isHas;\r\n}\r\n\r\nrouter.beforeEach((to,from,next)=>{\r\n    if(to.path == \"/login\"){\r\n        if(hasCookie){\r\n            next(\"/center\")\r\n        }else{\r\n            next(\"/\");\r\n        }\r\n    }else{\r\n        next();\r\n    }\r\n})\r\n\r\nexport default router;"],"mappings":"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"},"metadata":{},"sourceType":"module"}