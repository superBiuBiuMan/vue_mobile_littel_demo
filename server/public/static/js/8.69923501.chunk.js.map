{"version":3,"sources":["pages/UserCenter/index.jsx","utils/ajax.js","api/login.js"],"names":["Item","alert","UserCenter","state","userInfo","handleLogout","a","reqLogout","_id","props","history","replace","logout","text","onPress","style","backgroundColor","color","verifyLogin","reqVerifyLogin","setState","this","avatar","nickName","phone","className","mode","src","alt","renderHeader","extra","onClick","type","Component","ajax","axios","create","baseURL","timeout","interceptors","request","use","config","NProgress","start","response","done","data","code","fail","message","Promise","reject","error","console","log","reqVerifyCode","url","method","reqLogin","id"],"mappings":"oVAMOA,G,WAAAA,MACAC,E,IAAAA,MACcC,E,4MAEpBC,MAAQ,CACPC,SAAS,I,EAGVC,a,sBAAe,sBAAAC,EAAA,sEACRC,YAAU,EAAKJ,MAAMC,SAASI,KADtB,OAEd,EAAKC,MAAMC,QAAQC,QAAQ,UAFb,2C,EAKfC,OAAS,WACRX,EAAM,2BAAQ,mDAAY,CACzB,CAAEY,KAAM,gBACR,CAAEA,KAAM,eAAMC,QAAQ,EAAKT,aAAaU,MAAM,CAACC,gBAAgB,UAAUC,MAAM,a,EAIjFC,Y,sBAAc,4BAAAZ,EAAA,+EAEYa,cAFZ,OAENf,EAFM,OAGZ,EAAKgB,SAAS,CAAChB,aAHH,gDAKZ,EAAKK,MAAMC,QAAQC,QAAQ,UALf,yD,kEAUbU,KAAKH,gB,+BAGI,IAAD,EACwBG,KAAKlB,MAAMC,SAApCkB,EADC,EACDA,OAAOC,EADN,EACMA,SAASC,EADf,EACeA,MACvB,OACC,yBAAKC,UAAU,eACb,uBAAQC,KAAK,SAAb,4BACA,yBAAKD,UAAU,UACd,yBAAKE,IAAKL,EAAQM,IAAI,MAEvB,qEAAaJ,GACb,uBAAMK,aAAc,iBAAM,4BAAQJ,UAAU,aAC3C,kBAACzB,EAAD,CAAM8B,MAAOP,GAAb,gBACA,kBAACvB,EAAD,CAAM8B,MAAON,GAAb,uBAEF,uBAAQO,QAASV,KAAKT,OAAQoB,KAAK,WAAnC,iC,GA5CoCC,c,oFCElCC,G,MAAOC,IAAMC,OAAO,CACxBC,QAAS,IACTC,QAAS,OAIXJ,EAAKK,aAAaC,QAAQC,KACzB,SAAAC,GAGC,OADAC,IAAUC,QACHF,KAKTR,EAAKK,aAAaM,SAASJ,KAC1B,SAAAI,GAGC,OAFAF,IAAUG,OAEgB,MAAvBD,EAASE,KAAKC,KAETH,EAASE,KAAKA,MAGrB,IAAME,KAAKJ,EAASE,KAAKG,SAElBC,QAAQC,OAAOP,EAASE,KAAKG,aAItC,SAAAG,GAMC,OALAV,IAAUG,OAEVQ,QAAQC,IAAI,iFAAgBF,GAC5B,IAAMJ,KAAKI,EAAMH,SAEV,IAAIC,SAAQ,kBAINjB,O,gCClDf,oJAEasB,EAAgB,SAAChC,GAC7B,OAAOU,YAAK,CACXuB,IAAI,gBACJC,OAAO,OACPX,KAAK,CAACvB,YAGKmC,EAAW,SAACnC,EAAMwB,GAC9B,OAAOd,YAAK,CACXuB,IAAI,eACJC,OAAO,OACPX,KAAK,CAACvB,QAAMwB,WAGD7B,EAAiB,WAC7B,OAAOe,YAAK,CACXuB,IAAI,gBACJC,OAAO,UAGInD,EAAY,SAACqD,GACzB,OAAO1B,YAAK,CACXuB,IAAI,UACJC,OAAO,OACPX,KAAK,CAACvC,IAAIoD","file":"static/js/8.69923501.chunk.js","sourcesContent":["import React, { Component } from 'react'\r\nimport {reqVerifyLogin} from '@/api/login'\r\nimport { NavBar,Button,List,Modal} from 'antd-mobile';\r\nimport './index.less'\r\nimport {reqLogout} from '@/api/login'\r\n\r\nconst {Item} = List\r\nconst {alert} = Modal\r\nexport default class UserCenter extends Component {\r\n\r\n\tstate = {\r\n\t\tuserInfo:{}\r\n\t}\r\n\r\n\thandleLogout = async()=>{\r\n\t\tawait reqLogout(this.state.userInfo._id)\r\n\t\tthis.props.history.replace('/login')\r\n\t}\r\n\r\n\tlogout = ()=>{\r\n\t\talert('退出登录', '确定退出登录吗？', [\r\n\t\t\t{ text: '取消'},\r\n\t\t\t{ text: '确定', onPress:this.handleLogout,style:{backgroundColor:\"#F40700\",color:'white'}}\r\n\t\t])\r\n\t}\r\n\r\n\tverifyLogin = async()=>{\r\n\t\ttry {\r\n\t\t\tconst userInfo =  await reqVerifyLogin()\r\n\t\t\tthis.setState({userInfo})\r\n\t\t} catch (error) {\r\n\t\t\tthis.props.history.replace('/login')\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount(){\r\n\t\tthis.verifyLogin()\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {avatar,nickName,phone} = this.state.userInfo\r\n\t\treturn (\r\n\t\t\t<div className=\"user-center\">\r\n\t\t\t\t <NavBar mode=\"light\">个人中心</NavBar>\r\n\t\t\t\t <div className=\"avatar\">\r\n\t\t\t\t\t <img src={avatar} alt=\"\"/>\r\n\t\t\t\t </div>\r\n\t\t\t\t <span>欢迎，用户：{phone}</span>\r\n\t\t\t\t <List renderHeader={() => '个人信息'} className=\"info-list\">\r\n\t\t\t\t\t\t<Item extra={nickName}>昵称</Item>\r\n\t\t\t\t\t\t<Item extra={phone}>手机号</Item>\r\n\t\t\t\t </List>\r\n\t\t\t\t<Button onClick={this.logout} type=\"primary\">退出登录</Button>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n","//该文件是对axios的二次封装，可以：进度条效果、统一修改请求头、统一处理错误等等\r\nimport axios from 'axios'\r\n//引入NProgress制作请求进度条效果\r\nimport NProgress from 'nprogress'\r\n//引入nprogress样式\r\nimport 'nprogress/nprogress.css'\r\n//\r\nimport {Toast} from 'antd-mobile'\r\n\r\n//创建一个axios实例\r\nconst ajax = axios.create({\r\n  baseURL: '/', //请求公共路径\r\n  timeout: 3000, //超时时间\r\n});\r\n\r\n//应用请求拦截器\r\najax.interceptors.request.use(\r\n\tconfig => {\r\n\t\t//进度条开始走、给所有请求的请求头加token等等\r\n\t\tNProgress.start()\r\n\t\treturn config\r\n\t}\r\n)\r\n\r\n//应用响应拦截器\r\najax.interceptors.response.use(\r\n\tresponse => {\r\n\t\tNProgress.done()\r\n\t\t//响应成功了（状态码为2开头）\r\n\t\tif(response.data.code === 20000){\r\n\t\t\t//业务逻辑成功\r\n\t\t\treturn response.data.data\r\n\t\t}else{\r\n\t\t\t//业务逻辑失败\r\n\t\t\tToast.fail(response.data.message)\r\n\t\t\t//是否终止Promise链取决于具体业务，以后需要这个错误，进行进一步判断，就不要中断Promise链\r\n\t\t\treturn Promise.reject(response.data.message)\r\n\t\t\t// return new Promise(()=>{})\r\n\t\t}\r\n\t},\r\n\terror => {\r\n\t\tNProgress.done()\r\n\t\t//响应失败了（状态码不是2开头）\r\n\t\tconsole.log('响应拦截器失败的回调执行了',error);\r\n\t\tToast.fail(error.message)\r\n\t\t// return Promise.reject(error.message)\r\n\t\treturn new Promise(()=>{})\r\n\t}\r\n)\r\n\r\nexport default ajax","import ajax from '@/utils/ajax'\r\n\r\nexport const reqVerifyCode = (phone)=>{\r\n\treturn ajax({\r\n\t\turl:'/login/digits',\r\n\t\tmethod:'POST',\r\n\t\tdata:{phone}\r\n\t})\r\n}\r\nexport const reqLogin = (phone,code)=>{\r\n\treturn ajax({\r\n\t\turl:'/login/phone',\r\n\t\tmethod:'POST',\r\n\t\tdata:{phone,code}\r\n\t})\r\n}\r\nexport const reqVerifyLogin = ()=>{\r\n\treturn ajax({\r\n\t\turl:'/login/verify',\r\n\t\tmethod:'POST',\r\n\t})\r\n}\r\nexport const reqLogout = (id)=>{\r\n\treturn ajax({\r\n\t\turl:'/logout',\r\n\t\tmethod:'POST',\r\n\t\tdata:{_id:id}\r\n\t})\r\n}"],"sourceRoot":""}